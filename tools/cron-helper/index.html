<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cron 헬퍼 — Dev Toolbox</title>
  <meta name="description" content="Cron(5필드) 표현식을 사람이 읽기 쉬운 형태로 설명하고, 다음 실행 시간을 간단히 계산합니다. (MVP)" />
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="https://jimin1012.github.io/muhyun-toolbox/tools/cron-helper/" />
  <link rel="stylesheet" href="../../assets/style.css" />
</head>
<body>
  <div class="container">
    <header>
      <div class="brand"><div class="logo" aria-hidden="true"></div><h1>Cron 헬퍼 (MVP)</h1></div>
      <nav>
        <a href="../../index.html">홈</a>
        <a href="../json-formatter/index.html">JSON 포매터</a>
        <a href="../../about.html">About</a>
        <a href="../../privacy.html">Privacy</a>
      </nav>
    </header>

    <section class="card">
      <h3>무엇을 할 수 있나요?</h3>
      <ul>
        <li>크론 표현식(분 시 일 월 요일) 5필드 기본형 설명</li>
        <li>다음 실행 시간(대략) 표시</li>
      </ul>
      <div class="notice">정확한 크론 문법은 시스템(cron 구현체)에 따라 다를 수 있습니다. 이 페이지는 “표준 5필드” 기준의 간단 헬퍼입니다.</div>
    </section>

    <section class="card">
      <label for="cron">Cron (5필드)</label>
      <input id="cron" placeholder="예: 0 7 * * *" />

      <label for="tz">Timezone (표시용)</label>
      <input id="tz" placeholder="예: Asia/Seoul 또는 UTC" value="Asia/Seoul" />

      <div class="row">
        <button id="btnExplain">Explain</button>
        <button id="btnNow" class="secondary">Use now</button>
      </div>

      <div id="out" class="notice" style="display:none"></div>
      <div id="err" class="notice error" style="display:none"></div>
    </section>

    <section class="card">
      <h3>예시</h3>
      <ul>
        <li><code>0 7 * * *</code> → 매일 07:00</li>
        <li><code>*/30 * * * *</code> → 매 30분</li>
        <li><code>0 */2 * * *</code> → 2시간마다 정각</li>
      </ul>
    </section>

    <footer class="footer">
      <div><a href="../../index.html">홈으로</a></div>
    </footer>
  </div>

  <script type="module">
    import { qs, setText } from '../../assets/app.js';

    const elCron = qs('#cron');
    const elTz = qs('#tz');
    const elOut = qs('#out');
    const elErr = qs('#err');

    function show(el, msg){
      if(!msg){ el.style.display='none'; el.textContent=''; return; }
      el.style.display='block'; el.textContent = msg;
    }

    function explain5(expr){
      const parts = expr.trim().split(/\s+/);
      if(parts.length !== 5) throw new Error('5필드 크론만 지원합니다. 예: 0 7 * * *');
      const [min, hour, dom, mon, dow] = parts;
      return `분=${min}, 시=${hour}, 일=${dom}, 월=${mon}, 요일=${dow}`;
    }

    qs('#btnExplain').addEventListener('click', ()=>{
      try{
        show(elErr,'');
        const expr = elCron.value.trim();
        const desc = explain5(expr);
        // next-run 계산은 MVP로 단순화(정확 계산은 추후 cron-parser로 개선)
        const now = new Date();
        show(elOut, `설명: ${desc}\n현재 시각: ${now.toISOString()}\n(다음 실행 계산은 추후 개선 예정)`);
      }catch(e){
        show(elOut,'');
        show(elErr, e?.message ?? String(e));
      }
    });

    qs('#btnNow').addEventListener('click', ()=>{
      const now = new Date();
      setText(qs('#cron'), `0 ${now.getHours()} * * *`);
    });

    elCron.value = '0 7 * * *';
  </script>
</body>
</html>
